CREATE SCHEMA PUBLIC AUTHORIZATION DBA
CREATE MEMORY TABLE MATAVIMOVIENETAS(ID BIGINT NOT NULL PRIMARY KEY,KODAS VARCHAR(20) NOT NULL,PAVADINIMAS VARCHAR(100) NOT NULL,PASTABA VARCHAR(5000),CONSTRAINT SYS_CT_62 UNIQUE(KODAS))
CREATE MEMORY TABLE PREKES(ID BIGINT NOT NULL PRIMARY KEY,PAVADINIMAS VARCHAR(100) NOT NULL,MATVIENETASID BIGINT NOT NULL,PASTABA VARCHAR(5000),CONSTRAINT SYS_CT_66 UNIQUE(PAVADINIMAS),CONSTRAINT SYS_FK_67 FOREIGN KEY(MATVIENETASID) REFERENCES MATAVIMOVIENETAS(ID))
CREATE MEMORY TABLE TIEKEJAI(ID BIGINT NOT NULL PRIMARY KEY,PAVADINIMAS VARCHAR(100) NOT NULL,TELEFONAS VARCHAR(50) NOT NULL,ADRESAS VARCHAR(200) NOT NULL,PASTABA VARCHAR(5000),CONSTRAINT SYS_CT_74 UNIQUE(PAVADINIMAS))
CREATE MEMORY TABLE IMONES(ID BIGINT NOT NULL PRIMARY KEY,PAVADINIMAS VARCHAR(100) NOT NULL,TELEFONAS VARCHAR(50) NOT NULL,ADRESAS VARCHAR(200) NOT NULL,PASTABA VARCHAR(5000),CONSTRAINT SYS_CT_79 UNIQUE(PAVADINIMAS))
CREATE MEMORY TABLE SASKAITOS(ID BIGINT NOT NULL PRIMARY KEY,ARSASKAITA BOOLEAN NOT NULL,NUMERIS VARCHAR(100) NOT NULL,IMONEID BIGINT NOT NULL,TIEKEJASID BIGINT NOT NULL,DATA TIMESTAMP NOT NULL,SUMASUPVM NUMERIC NOT NULL,SUMABEPVM NUMERIC NOT NULL,SUMAPVM NUMERIC NOT NULL,PREKIUKIEKIS INTEGER NOT NULL,STATUSAS INTEGER,CONSTRAINT SYS_CT_91 UNIQUE(NUMERIS),CONSTRAINT SYS_FK_92 FOREIGN KEY(IMONEID) REFERENCES IMONES(ID),CONSTRAINT SYS_FK_93 FOREIGN KEY(TIEKEJASID) REFERENCES TIEKEJAI(ID))
CREATE MEMORY TABLE SASKAITOSPREKES(ID BIGINT NOT NULL PRIMARY KEY,SERIJA VARCHAR(100) NOT NULL,SASKAITAID BIGINT NOT NULL,PREKEID BIGINT NOT NULL,MATAVIMOVIENETASID BIGINT NOT NULL,KIEKIS NUMERIC NOT NULL,GALIOJAIKI TIMESTAMP,KAINABEPVM NUMERIC,NUOLAIDOSPROC NUMERIC,PVM NUMERIC,SUMAPVM NUMERIC,SUMASUPVM NUMERIC,SUMABEPVM NUMERIC,CONSTRAINT SYS_FK_101 FOREIGN KEY(MATAVIMOVIENETASID) REFERENCES MATAVIMOVIENETAS(ID),CONSTRAINT SYS_FK_102 FOREIGN KEY(PREKEID) REFERENCES PREKES(ID),CONSTRAINT SYS_FK_103 FOREIGN KEY(SASKAITAID) REFERENCES SASKAITOS(ID))
CREATE MEMORY TABLE LIKUCIAI(ID BIGINT NOT NULL PRIMARY KEY,DOKUMENTAS VARCHAR(100) NOT NULL,IRASOID BIGINT,PREKEID BIGINT NOT NULL,IMONEID BIGINT NOT NULL,MATAVIMOVIENETASID BIGINT NOT NULL,KIEKIS NUMERIC NOT NULL,GALIOJAIKI TIMESTAMP,SERIJA VARCHAR(100),DATA TIMESTAMP NOT NULL,ARSASKAITA BOOLEAN NOT NULL,CONSTRAINT SYS_FK_134 FOREIGN KEY(MATAVIMOVIENETASID) REFERENCES MATAVIMOVIENETAS(ID),CONSTRAINT SYS_FK_135 FOREIGN KEY(PREKEID) REFERENCES PREKES(ID),CONSTRAINT SYS_FK_136 FOREIGN KEY(IMONEID) REFERENCES IMONES(ID))
CREATE MEMORY TABLE NURASYMAI(ID BIGINT NOT NULL PRIMARY KEY,NUMERIS VARCHAR(100) NOT NULL,IMONEID BIGINT NOT NULL,DATA TIMESTAMP NOT NULL,PREKIUKIEKIS INTEGER NOT NULL,STATUSAS INTEGER,CONSTRAINT SYS_FK_149 FOREIGN KEY(IMONEID) REFERENCES IMONES(ID))
CREATE MEMORY TABLE NURASYMOPREKES(ID BIGINT NOT NULL PRIMARY KEY,SERIJA VARCHAR(100) NOT NULL,NURASYMASID BIGINT NOT NULL,PREKEID BIGINT NOT NULL,MATAVIMOVIENETASID BIGINT NOT NULL,KIEKIS NUMERIC NOT NULL,CONSTRAINT SYS_FK_154 FOREIGN KEY(MATAVIMOVIENETASID) REFERENCES MATAVIMOVIENETAS(ID),CONSTRAINT SYS_FK_155 FOREIGN KEY(PREKEID) REFERENCES PREKES(ID))
CREATE VIEW VPREKES (ID,PAVADINIMAS,MATVIENETAS) AS select p.Id, p.Pavadinimas, v.kodas as matVienetas from prekes p left join MATAVIMOVIENETAS v on p.MATVIENETASID = v.id
CREATE VIEW VSASKAITOS (ID,ARSASKAITA,NUMERIS,SUMASUPVM,STATUSAS,DATA,IMONE,TIEKEJAS) AS select s.Id, s.arSaskaita, s.numeris, s.SUMASUPVM, s.STATUSAS, s.DATA, i.PAVADINIMAS as imone, t.PAVADINIMAS as tiekejas\u000a\u0009from saskaitos s \u0009left join imones i on s.IMONEID = i.id\u000a\u0009\u0009\u0009\u0009\u0009left join TIEKEJAI t on s.TIEKEJASID = t.id
CREATE VIEW VLIKUCIAIINT (PREKEID,MATAVIMOVIENETASID,IMONEID,KIEKIS,DATA,ID,PAJAMUOTA) AS select l.PREKEID, min(l.MATAVIMOVIENETASID) as MATAVIMOVIENETASID, l.IMONEID, sum(l.KIEKIS) as kiekis, max(l.DATA) as data, min(l.id) as id, sum(Case When l.KIEKIS > 0 Then l.KIEKIS Else 0 End) as pajamuota\u000a\u0009from likuciai l group by l.prekeid, l.imoneid
CREATE VIEW VLIKUCIAI (ID,KIEKIS,PAJAMUOTA,DATA,IMONE,MATAVIMOVIENETAS,PREKE) AS select l.Id, l.kiekis, l.PAJAMUOTA, l.DATA, i.PAVADINIMAS as imone, mv.KODAS as matavimovienetas, p.PAVADINIMAS as preke\u000a\u0009from vLikuciaiInt l left join imones i on l.IMONEID = i.id\u000a\u0009\u0009\u0009\u0009\u0009left join Prekes p on l.PREKEID = p.id\u000a\u0009\u0009\u0009\u0009\u0009left join MATAVIMOVIENETAS mv on mv.id = l.MATAVIMOVIENETASID
CREATE VIEW VNURASYMAI (ID,NUMERIS,STATUSAS,DATA,IMONE) AS select n.Id, n.numeris, n.STATUSAS, n.DATA, i.PAVADINIMAS as imone\u000a\u0009from NURASYMAI n \u0009left join imones i on n.IMONEID = i.id
CREATE USER SA PASSWORD ""
GRANT DBA TO SA
SET WRITE_DELAY 10
SET SCHEMA PUBLIC
INSERT INTO MATAVIMOVIENETAS VALUES(1,'flk','Flakonas',NULL)
INSERT INTO MATAVIMOVIENETAS VALUES(2,'vnt','Vienetas',NULL)
INSERT INTO MATAVIMOVIENETAS VALUES(3,'kg','Kilogramas',NULL)
INSERT INTO MATAVIMOVIENETAS VALUES(4,'g','Gramas',NULL)
INSERT INTO PREKES VALUES(1,'P1',1,'Pastaba\u000a\u000a\u000apastaba')
INSERT INTO PREKES VALUES(2,'P2',2,NULL)
INSERT INTO PREKES VALUES(3,'Vaistas 2',4,'Olia olia')
INSERT INTO PREKES VALUES(4,'Vaistas 3',3,'Olias')
INSERT INTO TIEKEJAI VALUES(1,'Tiek\u0117jas 1','86020202','Adresas 1','Pastabas apie \u0161\u012f tiek\u0117j\u0105')
INSERT INTO TIEKEJAI VALUES(2,'Tiekejas 2','23123123','olias','1231231234214')
INSERT INTO IMONES VALUES(1,'Smilgi\u0173 \u017d\u016aB','860207118','zaros 3','gaidys, vista, visciukas')
INSERT INTO IMONES VALUES(2,'Kazupis','','Gavaltuva','')
INSERT INTO IMONES VALUES(3,'valio','','','')
INSERT INTO SASKAITOS VALUES(1,FALSE,'3',1,1,'2012-12-12 00:00:00.000000000',0,0,0,0,1)
INSERT INTO SASKAITOS VALUES(2,FALSE,'2',1,1,'2012-12-10 00:00:00.000000000',0,0,0,0,1)
INSERT INTO SASKAITOS VALUES(3,FALSE,'4',2,1,'2012-12-10 00:00:00.000000000',0,0,0,0,1)
INSERT INTO SASKAITOS VALUES(7,FALSE,'5',2,1,'2012-12-12 00:00:00.000000000',0,0,0,0,1)
INSERT INTO SASKAITOS VALUES(8,FALSE,'6',2,1,'2012-12-12 00:00:00.000000000',0,0,0,0,1)
INSERT INTO SASKAITOS VALUES(9,FALSE,'7',1,1,'2012-12-16 00:00:00.000000000',0,0,0,0,1)
INSERT INTO SASKAITOSPREKES VALUES(1,'Olia',2,1,1,1,'2012-12-12 00:00:00.000000000',15.15,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(2,'Olia 2',2,2,2,3,'2012-12-15 00:00:00.000000000',10.10,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(3,'Wowo',2,1,1,4,'2012-12-30 00:00:00.000000000',10.90,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(4,'12312',1,2,2,10,'2012-12-30 00:00:00.000000000',12,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(5,'13131',3,1,1,50,'2013-10-12 00:00:00.000000000',15,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(6,'13333333',3,2,2,100,'2013-10-10 00:00:00.000000000',12,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(10,'1323',7,2,2,15,'2012-12-30 00:00:00.000000000',1.15,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(11,'131313',8,3,4,10,'2013-01-02 00:00:00.000000000',20,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(14,'4',8,2,2,10,'2013-01-02 00:00:00.000000000',NULL,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(15,'5',8,1,1,15,'2013-01-02 00:00:00.000000000',NULL,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(16,'6',8,4,3,2,'2013-01-02 00:00:00.000000000',NULL,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(17,'1',9,1,1,10,'2012-12-12 00:00:00.000000000',NULL,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(18,'2',9,2,2,10,'2012-12-12 00:00:00.000000000',NULL,NULL,NULL,NULL,NULL,NULL)
INSERT INTO SASKAITOSPREKES VALUES(19,'3',9,3,4,10,'2012-12-12 00:00:00.000000000',NULL,NULL,NULL,NULL,NULL,NULL)
INSERT INTO LIKUCIAI VALUES(1,'2',1,1,1,1,1,'2012-12-12 00:00:00.000000000','Olia','2012-12-10 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(2,'2',2,2,1,2,3,'2012-12-15 00:00:00.000000000','Olia 2','2012-12-10 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(3,'2',3,1,1,1,4,'2012-12-30 00:00:00.000000000','Wowo','2012-12-10 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(4,'3',4,2,1,2,10,'2012-12-30 00:00:00.000000000','12312','2012-12-12 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(5,'4',5,1,2,1,50,'2013-10-12 00:00:00.000000000','13131','2012-12-10 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(6,'4',6,2,2,2,100,'2013-10-10 00:00:00.000000000','13333333','2012-12-10 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(7,'5',10,2,2,2,15,'2012-12-30 00:00:00.000000000','1323','2012-12-12 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(8,'6',11,3,2,4,10,'2013-01-02 00:00:00.000000000','131313','2012-12-12 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(9,'6',14,2,2,2,10,'2013-01-02 00:00:00.000000000','4','2012-12-12 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(10,'6',15,1,2,1,15,'2013-01-02 00:00:00.000000000','5','2012-12-12 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(11,'6',16,4,2,3,2,'2013-01-02 00:00:00.000000000','6','2012-12-12 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(12,'12-2',1,1,2,1,-10,NULL,'13131','2012-12-15 00:00:00.000000000',FALSE)
INSERT INTO LIKUCIAI VALUES(13,'2131',2,3,2,1,-10,NULL,'131313','2012-12-15 00:00:00.000000000',FALSE)
INSERT INTO LIKUCIAI VALUES(14,'7',17,1,1,1,10,'2012-12-12 00:00:00.000000000','1','2012-12-16 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(15,'7',18,2,1,2,10,'2012-12-12 00:00:00.000000000','2','2012-12-16 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(16,'7',19,3,1,4,10,'2012-12-12 00:00:00.000000000','3','2012-12-16 00:00:00.000000000',TRUE)
INSERT INTO LIKUCIAI VALUES(17,'7',12,1,1,1,-2,NULL,'1','2012-12-16 00:00:00.000000000',FALSE)
INSERT INTO LIKUCIAI VALUES(18,'7',13,2,1,2,-3,NULL,'2','2012-12-16 00:00:00.000000000',FALSE)
INSERT INTO LIKUCIAI VALUES(19,'7',14,3,1,4,-4,NULL,'3','2012-12-16 00:00:00.000000000',FALSE)
INSERT INTO NURASYMAI VALUES(1,'12-1',1,'2012-12-15 00:00:00.000000000',0,0)
INSERT INTO NURASYMAI VALUES(2,'12-2',2,'2012-12-15 00:00:00.000000000',0,1)
INSERT INTO NURASYMAI VALUES(3,'2131',2,'2012-12-15 00:00:00.000000000',0,0)
INSERT INTO NURASYMAI VALUES(4,'2131',2,'2012-12-15 00:00:00.000000000',0,1)
INSERT INTO NURASYMAI VALUES(5,'12-3',1,'2012-12-16 00:00:00.000000000',0,0)
INSERT INTO NURASYMAI VALUES(6,'12-3',1,'2012-12-16 00:00:00.000000000',0,0)
INSERT INTO NURASYMAI VALUES(7,'12-3',1,'2012-12-16 00:00:00.000000000',0,0)
INSERT INTO NURASYMAI VALUES(8,'12-3',1,'2012-12-16 00:00:00.000000000',0,0)
INSERT INTO NURASYMAI VALUES(9,'7',1,'2012-12-16 00:00:00.000000000',0,1)
INSERT INTO NURASYMOPREKES VALUES(1,'13131',2,1,1,10)
INSERT INTO NURASYMOPREKES VALUES(2,'131313',4,3,1,10)
INSERT INTO NURASYMOPREKES VALUES(3,'123',5,1,1,2)
INSERT INTO NURASYMOPREKES VALUES(4,'123',6,1,1,2)
INSERT INTO NURASYMOPREKES VALUES(5,'123',6,2,2,3)
INSERT INTO NURASYMOPREKES VALUES(6,'123',7,1,1,2)
INSERT INTO NURASYMOPREKES VALUES(7,'123',7,2,2,3)
INSERT INTO NURASYMOPREKES VALUES(8,'123',7,3,4,4)
INSERT INTO NURASYMOPREKES VALUES(9,'123',8,1,1,2)
INSERT INTO NURASYMOPREKES VALUES(10,'123',8,2,2,3)
INSERT INTO NURASYMOPREKES VALUES(11,'123',8,3,4,4)
INSERT INTO NURASYMOPREKES VALUES(12,'1',9,1,1,2)
INSERT INTO NURASYMOPREKES VALUES(13,'2',9,2,2,3)
INSERT INTO NURASYMOPREKES VALUES(14,'3',9,3,4,4)
